# ============================================================================
# INNOGRAM ENVIRONMENT CONFIGURATION
# ============================================================================
# Copy this file to .env for development or .env.production for production
#
# DEVELOPMENT SETUP:
#   cp .env.example .env
#   npm run docker:dev    # Start PostgreSQL:5433, Redis:6380, RabbitMQ:5672
#   npm run dev           # Start all apps with hot reload
#
# PRODUCTION SETUP:
#   cp .env.example .env.production
#   # Update values for production (see comments below)
#   npm run docker:prod   # Start all services in Docker
# ============================================================================

# ======================================
# GENERAL CONFIGURATION
# ======================================
NODE_ENV=development
# Production: NODE_ENV=production

# ======================================
# DATABASE CONFIGURATION
# ======================================

# PostgreSQL (Main Database)
# Development: localhost with non-standard port to avoid conflicts
# Production: Docker service name "postgres" with standard port
POSTGRES_HOST=localhost
# Production: POSTGRES_HOST=postgres
POSTGRES_DB=innogram
POSTGRES_USER=postgres
POSTGRES_PASSWORD=password
# Production: Use a strong password like "iNCo06_XIX1\;q1"
POSTGRES_PORT=5433
# Production: POSTGRES_PORT=5432

# Application Database User (created by init-db.sql)
APP_DB_USER=innogram_user
APP_DB_PASSWORD=innogram_app_password

# Redis (Cache/Sessions)
# Development: Non-standard port 6380
# Production: Standard port 6379
REDIS_PASSWORD=secure_redis_password
REDIS_PORT=6380
# Production: REDIS_PORT=6379
# Production: REDIS_URL=redis://:secure_redis_password@redis:6379

# RabbitMQ (Message Queue)
RABBITMQ_USER=admin
RABBITMQ_PASSWORD=rabbitmq_password
RABBITMQ_PORT=5672
RABBITMQ_MGMT_PORT=15672

# ======================================
# AUTHENTICATION SERVICE (Port 4000)
# ======================================
AUTH_PORT=4000

# Frontend URL for OAuth callbacks and redirects
FRONTEND_URL=http://localhost:3000
# Production: FRONTEND_URL=https://your-domain.com

# Core Service URL (internal communication)
CORE_SERVICE_URL=http://localhost:8000
# Production: CORE_SERVICE_URL=http://core-server:8000

# JWT Configuration
# IMPORTANT: Generate unique secrets for production!
# Example: openssl rand -base64 32
JWT_ACCESS_SECRET=your_access_secret_minimum_32_characters_long
JWT_REFRESH_SECRET=your_refresh_secret_minimum_32_characters_long
JWT_ACCESS_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# OAuth - Google
# Get credentials from: https://console.cloud.google.com/apis/credentials
# Authorized redirect URIs:
#   Development: http://localhost:8000/api/auth/google/callback
#   Production:  https://your-domain.com/innogram/api/auth/google/callback
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=GOCSPX-your-google-client-secret

# ======================================
# CORE SERVER (Port 8000)
# ======================================
CORE_SERVER_PORT=8000

# Auth Service URL (internal communication)
AUTH_SERVICE_URL=http://localhost:4000
# Production: AUTH_SERVICE_URL=http://auth-service:4000

# Client Application URL (for email links, internal)
CLIENT_URL=http://localhost:3000
# Production: CLIENT_URL=http://client-app:3000

# Database URL (Prisma connection string)
DATABASE_URL=postgresql://innogram_user:innogram_app_password@localhost:5433/innogram?schema=public
# Production: DATABASE_URL=postgresql://innogram_user:innogram_app_password@postgres:5432/innogram?schema=public

# WebSocket Configuration
SOCKET_IO_CORS_ORIGIN=http://localhost:3000
# Production: SOCKET_IO_CORS_ORIGIN=https://your-domain.com
SOCKET_IO_PING_TIMEOUT=60000
SOCKET_IO_PING_INTERVAL=25000

# File Upload Configuration
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=10485760
MAX_IMAGE_SIZE=10485760
MAX_VIDEO_SIZE=104857600

# Production Only - Public URLs for browser redirects (behind reverse proxy)
# CORE_PUBLIC_URL=https://your-domain.com/innogram
# AUTH_PUBLIC_URL=https://your-domain.com/innogram
# BACKEND_URL=https://your-domain.com/innogram

# ======================================
# STORAGE CONFIGURATION (Cloudflare R2)
# ======================================
# Development uses local filesystem (./uploads)
# Production uses Cloudflare R2 (S3-compatible object storage)
#
# To set up Cloudflare R2:
#   1. Go to: https://dash.cloudflare.com -> R2 Object Storage
#   2. Create a bucket (e.g., "innogram-uploads")
#   3. Enable public access or use a custom domain
#   4. Create API tokens: R2 -> Manage R2 API Tokens
#   5. Create token with "Object Read & Write" permissions
#
# STORAGE_TYPE=r2
# CLOUDFLARE_ENDPOINT_S3_CLIENT=https://<account_id>.r2.cloudflarestorage.com
# CLOUDFLARE_ACCESS_KEY_ID=your-r2-access-key-id
# CLOUDFLARE_SECRET_ACCESS_KEY=your-r2-secret-access-key
# CLOUDFLARE_BUCKET=innogram-uploads
# CLOUDFLARE_PUBLIC_URL=https://pub-xxxxx.r2.dev
# Or with custom domain:
# CLOUDFLARE_PUBLIC_URL=https://cdn.your-domain.com

# ======================================
# CLIENT APPLICATION (Port 3000)
# ======================================
CLIENT_PORT=3000

# Next.js Public Environment Variables
NEXT_PUBLIC_API_URL=http://localhost:8000
# Production: NEXT_PUBLIC_API_URL=https://your-domain.com/innogram
NEXT_PUBLIC_AUTH_URL=http://localhost:4000
# Production: NEXT_PUBLIC_AUTH_URL=https://your-domain.com/innogram/internal/auth

# NextAuth Configuration
NEXTAUTH_SECRET=nextauth_secret_minimum_32_characters_long
NEXTAUTH_URL=http://localhost:3000
# Production: NEXTAUTH_URL=https://your-domain.com/innogram

# Production Only - Base path for reverse proxy deployment
# NEXT_PUBLIC_BASE_PATH=/innogram

# ======================================
# NOTIFICATIONS CONSUMER
# ======================================

# RabbitMQ Connection URL
RABBITMQ_URL=amqp://admin:rabbitmq_password@localhost:5672
# Production: RABBITMQ_URL=amqp://admin:rabbitmq_password@rabbitmq:5672

# Email Configuration
# Option 1: Gmail (requires App Password)
#   1. Enable 2FA: https://myaccount.google.com/security
#   2. Generate App Password: https://myaccount.google.com/apppasswords
#   3. Use the 16-character app password below
# MAIL_HOST=smtp.gmail.com
# MAIL_PORT=587
# MAIL_USER=your-email@gmail.com
# MAIL_PASSWORD=xxxx xxxx xxxx xxxx

# Option 2: Mailgun (recommended for production)
#   Sign up at: https://www.mailgun.com
#   Note: DigitalOcean blocks ports 25, 465, 587 - use port 2525
# MAIL_HOST=smtp.mailgun.org
# MAIL_HOST=smtp.eu.mailgun.org  # For EU region
# MAIL_PORT=2525
# MAIL_USER=postmaster@mg.your-domain.com
# MAIL_PASSWORD=your-mailgun-smtp-password

# Default email settings (update for your provider)
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_USER=your-email@example.com
MAIL_PASSWORD=your-email-password
MAIL_FROM=noreply@example.com

# ======================================
# PRODUCTION CONFIGURATION CHECKLIST
# ======================================
# When deploying to production, ensure you update:
#
# 1. NODE_ENV=production
#
# 2. Database hosts to Docker service names:
#    - POSTGRES_HOST=postgres
#    - REDIS_URL=redis://:password@redis:6379
#    - RABBITMQ_URL=amqp://admin:password@rabbitmq:5672
#
# 3. Database ports to standard:
#    - POSTGRES_PORT=5432
#    - REDIS_PORT=6379
#
# 4. Strong passwords for:
#    - POSTGRES_PASSWORD
#    - REDIS_PASSWORD
#    - JWT_ACCESS_SECRET
#    - JWT_REFRESH_SECRET
#    - NEXTAUTH_SECRET
#
# 5. Production URLs (replace your-domain.com):
#    - FRONTEND_URL=https://your-domain.com
#    - NEXT_PUBLIC_API_URL=https://your-domain.com/innogram
#    - NEXT_PUBLIC_AUTH_URL=https://your-domain.com/innogram/internal/auth
#    - NEXTAUTH_URL=https://your-domain.com/innogram
#    - SOCKET_IO_CORS_ORIGIN=https://your-domain.com
#    - CORE_PUBLIC_URL=https://your-domain.com/innogram
#    - AUTH_PUBLIC_URL=https://your-domain.com/innogram
#    - BACKEND_URL=https://your-domain.com/innogram
#
# 6. Internal Docker service URLs:
#    - CORE_SERVICE_URL=http://core-server:8000
#    - AUTH_SERVICE_URL=http://auth-service:4000
#    - CLIENT_URL=http://client-app:3000
#    - DATABASE_URL=postgresql://user:pass@postgres:5432/innogram
#
# 7. Base path for reverse proxy:
#    - NEXT_PUBLIC_BASE_PATH=/innogram
#
# 8. OAuth callback URLs in Google Console:
#    - https://your-domain.com/innogram/api/auth/google/callback
#
# 9. Email provider (Mailgun recommended):
#    - Use port 2525 for DigitalOcean (ports 25, 465, 587 blocked)
#
# 10. Cloudflare R2 for file storage:
#    - STORAGE_TYPE=r2
#    - CLOUDFLARE_ENDPOINT_S3_CLIENT=https://<account_id>.r2.cloudflarestorage.com
#    - CLOUDFLARE_ACCESS_KEY_ID=your-r2-access-key-id
#    - CLOUDFLARE_SECRET_ACCESS_KEY=your-r2-secret-access-key
#    - CLOUDFLARE_BUCKET=innogram-uploads
#    - CLOUDFLARE_PUBLIC_URL=https://pub-xxxxx.r2.dev
